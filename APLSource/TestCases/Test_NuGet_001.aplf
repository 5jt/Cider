 R←Test_NuGet_001(stopFlag batchFlag);⎕TRAP;parms;I;tempFolder;msg;rc
⍝ Open a project with no dependencies, add a NuGet dependency, close and reopen
 ⎕TRAP←(999 'C' '∘∘∘ ⍝ Deliberate error')(0 'N')
 R←T._Failed

 tempFolder←∆GetFolderInTempDir⊃⎕SI
 parms←APLProcess.CreateParms
 parms.Exe←1⊃2 ⎕NQ #'GetCommandLineArgs' 'DYALOG'
 parms.OutputFilename←(739⌶0),'/',(⊃⎕SI),'.txt'
 parms.CommandLineArgs,←'path=''',tempFolder,''''
 parms.CommandLineArgs,←' fns=∆',(⊃⎕SI)
 parms.CommandLineArgs,←' codeCoverageFile=''',(T.codeCoverage.filename~''''),''''
 parms.CommandLineArgs,←' DYALOG_NETCORE=1'
 parms.WorkspaceName←##.CiderConfig.HOME,'/Tests/ExecTestCase.dws'
 parms.WindowsStyle←'Normal'
 :If 0
     parms.SessionFile←1            ⍝ Only for development/debugging
     parms.CommandLineArgs,←' -x'
 :EndIf

 I←⎕NEW APLProcess(,⊂parms)
 R←I.ExitCode

∆TidyUp:
 (rc msg)←FilesAndDirs.RmDirByForce tempFolder
 msg Assert 0=rc
⍝Done
